<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>CEO Dashboard — Harkein Synergies</title>
  <link rel="icon" href="https://i.ibb.co/RpKv1djv/file-0000000043cc620a9e2842b1759c4eac-conversation-id-681fc7fd-2814-800f-981e-7caabb6ca2dd-message-i.png" type="image/png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    :root{ --navy: #0f172a; --gold: #d4af37; --white: #ffffff; --grey: #f1f5f9; }
    *{box-sizing:border-box}
    body{font-family: 'Segoe UI', sans-serif; margin:0; background:var(--navy); color:#333; height: 100vh; overflow: hidden;}

    #login-screen { position: fixed; inset: 0; background: var(--navy); z-index: 2000; display: flex; align-items: center; justify-content: center; flex-direction: column; }
    .login-box { background: white; padding: 40px; border-radius: 8px; text-align: center; width: 350px; border-top: 5px solid var(--gold); }
    .login-box h2 { margin-top: 0; color: var(--navy); }
    .login-box input { width: 100%; padding: 12px; margin: 15px 0; border: 1px solid #ccc; border-radius: 4px; font-size: 16px; text-align: center;}
    .login-btn { width: 100%; padding: 12px; background: var(--navy); color: white; border: none; font-weight: bold; cursor: pointer; transition: 0.3s; }
    .login-btn:hover { background: var(--gold); color: var(--navy); }

    #main-interface { display: none; height: 100vh; } 
    
    .sidebar { width: 260px; background: rgba(0,0,0,0.3); border-right: 1px solid rgba(255,255,255,0.1); display: flex; flex-direction: column; padding: 20px; overflow-y: auto; }
    .brand { color: white; font-size: 20px; font-weight: 800; margin-bottom: 30px; text-transform: uppercase; letter-spacing: 1px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 20px; }
    .brand span { color: var(--gold); }
    
    /* SESSION TIMER */
    .session-timer {
      background: rgba(212,175,55,0.2);
      color: var(--gold);
      padding: 10px;
      border-radius: 4px;
      font-size: 12px;
      text-align: center;
      margin-bottom: 20px;
    }
    .session-timer.warning {
      background: rgba(239,68,68,0.2);
      color: #ef4444;
      animation: pulse 1s infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    
    .nav-category { color: var(--gold); font-size: 12px; text-transform: uppercase; font-weight: bold; margin-top: 20px; margin-bottom: 10px; }
    .nav-item { padding: 12px 15px; color: rgba(255,255,255,0.8); cursor: pointer; border-radius: 4px; margin-bottom: 5px; transition: 0.2s; display: flex; align-items: center; gap: 10px; font-size: 14px; }
    .nav-item:hover, .nav-item.active { background: var(--gold); color: var(--navy); font-weight: 700; }
    
    .main-content { flex: 1; background: var(--grey); padding: 40px; overflow-y: auto; }
    .panel { display: none; animation: fadeIn 0.3s; }
    .panel.active { display: block; }
    
    h2 { color: var(--navy); border-bottom: 2px solid var(--gold); padding-bottom: 10px; display: inline-block; margin-top: 0; }
    p.desc { color: #666; margin-bottom: 20px; }
    
    .form-group { background: white; padding: 25px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); max-width: 800px; margin-bottom: 20px; }
    label { display: block; margin-bottom: 8px; font-weight: 600; color: var(--navy); font-size: 14px; }
    input, select, textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; margin-bottom: 20px; font-family: inherit; }
    .btn-generate { background: var(--navy); color: white; border: none; padding: 12px 24px; font-weight: bold; cursor: pointer; border-radius: 4px; width: 100%; transition: 0.3s; }
    .btn-generate:hover { background: var(--gold); color: var(--navy); }

    .items-list { max-width: 800px; }
    .item-card { background: white; padding: 20px; border-radius: 8px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
    .item-card h3 { margin: 0 0 10px 0; color: var(--navy); }
    .item-card p { margin: 5px 0; color: #666; font-size: 14px; }
    .item-actions { display: flex; gap: 10px; margin-top: 15px; }
    .btn-delete { background: #dc2626; color: white; border: none; padding: 8px 16px; cursor: pointer; border-radius: 4px; font-size: 13px; }
    .btn-delete:hover { background: #b91c1c; }

    .success-msg { background: #10b981; color: white; padding: 15px; border-radius: 4px; margin-bottom: 20px; display: none; }
    .error-msg { background: #ef4444; color: white; padding: 15px; border-radius: 4px; margin-bottom: 20px; display: none; }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    
    @media (max-width: 768px) {
      #main-interface { flex-direction: column; }
      .sidebar { width: 100%; height: auto; max-height: 200px; }
      .main-content { padding: 20px; }
    }
  </style>
</head>
<body>

  <div id="login-screen">
    <div class="login-box">
      <h2>CEO ACCESS</h2>
      <p>Enter Access PIN</p>
      <input type="password" id="password" placeholder="****">
      <button class="login-btn" onclick="checkLogin()">UNLOCK DASHBOARD</button>
      <p id="error-msg" style="color: red; display: none; margin-top: 10px; font-size: 14px;">Access Denied</p>
    </div>
  </div>

  <div id="main-interface">
    
    <div class="sidebar">
      <div class="brand">HARKEIN <span>ADMIN</span></div>
      
      <div class="session-timer" id="session-timer">
        <i class="fas fa-clock"></i> Session: <span id="timer-display">30:00</span>
      </div>
      
      <div class="nav-category">Core Business</div>
      <div class="nav-item active" onclick="switchTab('fashion')"><i class="fas fa-tshirt"></i> Fashion Store</div>
      <div class="nav-item" onclick="switchTab('realestate')"><i class="fas fa-building"></i> Real Estate</div>
      
      <div class="nav-category">Billionaire Sectors</div>
      <div class="nav-item" onclick="switchTab('energy')"><i class="fas fa-gas-pump"></i> Energy & Agric</div>
      <div class="nav-item" onclick="switchTab('solutions')"><i class="fas fa-chart-line"></i> Data & FMCG</div>
      <div class="nav-item" onclick="switchTab('logistics')"><i class="fas fa-truck-moving"></i> Logistics</div>

      <div class="nav-category">Media Center</div>
      <div class="nav-item" onclick="switchTab('news')"><i class="fas fa-newspaper"></i> Post News</div>
      <div class="nav-item" onclick="switchTab('gallery')"><i class="fas fa-images"></i> Update Gallery</div>

                <div style="margin-top: 20px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px;">
        <div class="nav-item" onclick="logout()" style="color: var(--gold); border: 1px solid var(--gold); font-weight: bold; justify-content: center;">
          <i class="fas fa-sign-out-alt"></i> LOGOUT
        </div>
      </div>
    </div>

    <div class="main-content">
      
      <div id="fashion" class="panel active">
        <h2>Fashion Store</h2>
        <p class="desc">Add new fashion items to your store</p>
        
        <div class="success-msg" id="fashion-success"></div>
        <div class="error-msg" id="fashion-error"></div>
        
        <div class="form-group">
          <label>Image Link (URL)</label>
          <input type="text" id="f-img" placeholder="https://...">
          <label>Category</label>
          <select id="f-cat">
            <option>Men's Luxury</option>
            <option>Women's Luxury</option>
            <option>Accessories</option>
          </select>
          <label>Product Name</label>
          <input type="text" id="f-name" placeholder="e.g. Navy Blue Bespoke Suit">
          <label>Price (₦)</label>
          <input type="text" id="f-price" placeholder="e.g. 150,000">
          <button class="btn-generate" onclick="saveFashion()">Save to Database</button>
        </div>

        <h3 style="margin-top: 40px; color: var(--navy);">Current Items</h3>
        <div class="items-list" id="fashion-list"></div>
      </div>

      <div id="realestate" class="panel">
        <h2>Real Estate</h2>
        <p class="desc">Add properties to your portfolio</p>
        
        <div class="success-msg" id="property-success"></div>
        <div class="error-msg" id="property-error"></div>
        
        <div class="form-group">
          <label>Image Link</label>
          <input type="text" id="p-img" placeholder="https://...">
          <label>Status</label>
          <select id="p-status"><option>For Sale</option><option>For Rent</option></select>
          <label>Location</label>
          <input type="text" id="p-loc" placeholder="Lekki, Lagos">
          <label>Title</label>
          <input type="text" id="p-title" placeholder="4 Bedroom Duplex">
          <label>Price</label>
          <input type="text" id="p-price" placeholder="₦120,000,000">
          <button class="btn-generate" onclick="saveProperty()">Save to Database</button>
        </div>

        <h3 style="margin-top: 40px; color: var(--navy);">Current Properties</h3>
        <div class="items-list" id="property-list"></div>
      </div>

      <div id="energy" class="panel">
        <h2>Energy & Agriculture</h2>
        <p class="desc">Add energy and agriculture services</p>
        
        <div class="success-msg" id="energy-success"></div>
        <div class="error-msg" id="energy-error"></div>
        
        <div class="form-group">
          <label>Image Link</label>
          <input type="text" id="e-img" placeholder="https://...">
          <label>Service Title</label>
          <input type="text" id="e-title" placeholder="e.g. Bulk Diesel Supply">
          <label>Description</label>
          <textarea id="e-desc" rows="3" placeholder="Description..."></textarea>
          <button class="btn-generate" onclick="saveEnergy()">Save to Database</button>
        </div>

        <h3 style="margin-top: 40px; color: var(--navy);">Current Services</h3>
        <div class="items-list" id="energy-list"></div>
      </div>

      <div id="solutions" class="panel">
        <h2>Data & FMCG Solutions</h2>
        <p class="desc">Add business solutions</p>
        
        <div class="success-msg" id="solutions-success"></div>
        <div class="error-msg" id="solutions-error"></div>
        
        <div class="form-group">
          <label>Image Link</label>
          <input type="text" id="s-img" placeholder="https://...">
          <label>Service Title</label>
          <input type="text" id="s-title" placeholder="e.g. Data Analysis">
          <label>Description</label>
          <textarea id="s-desc" rows="3" placeholder="Description..."></textarea>
          <button class="btn-generate" onclick="saveSolutions()">Save to Database</button>
        </div>

        <h3 style="margin-top: 40px; color: var(--navy);">Current Solutions</h3>
        <div class="items-list" id="solutions-list"></div>
      </div>

      <div id="logistics" class="panel">
        <h2>Logistics Services</h2>
        <p class="desc">Add logistics and procurement services</p>
        
        <div class="success-msg" id="logistics-success"></div>
        <div class="error-msg" id="logistics-error"></div>
        
        <div class="form-group">
          <label>Icon Class (FontAwesome)</label>
          <input type="text" id="l-icon" placeholder="fas fa-truck">
          <label>Service Title</label>
          <input type="text" id="l-title" placeholder="e.g. Haulage Services">
          <label>Description</label>
          <textarea id="l-desc" rows="3" placeholder="Description..."></textarea>
          <button class="btn-generate" onclick="saveLogistics()">Save to Database</button>
        </div>

        <h3 style="margin-top: 40px; color: var(--navy);">Current Services</h3>
        <div class="items-list" id="logistics-list"></div>
      </div>

      <div id="news" class="panel">
        <h2>News Updates</h2>
        <p class="desc">Post news and announcements</p>
        
        <div class="success-msg" id="news-success"></div>
        <div class="error-msg" id="news-error"></div>
        
        <div class="form-group">
          <label>Image Link</label>
          <input type="text" id="n-img" placeholder="https://...">
          <label>Date</label>
          <input type="text" id="n-date" placeholder="Jan 01, 2026">
          <label>Headline</label>
          <input type="text" id="n-title" placeholder="e.g. Partnership with Shell">
          <label>Short Summary</label>
          <textarea id="n-desc" rows="3" placeholder="Summary..."></textarea>
          <label>Link To Page (Optional)</label>
          <input type="text" id="n-link" placeholder="contact.html">
          <button class="btn-generate" onclick="saveNews()">Save to Database</button>
        </div>

        <h3 style="margin-top: 40px; color: var(--navy);">Recent News</h3>
        <div class="items-list" id="news-list"></div>
      </div>

      <div id="gallery" class="panel">
        <h2>Gallery</h2>
        <p class="desc">Update your project gallery</p>
        
        <div class="success-msg" id="gallery-success"></div>
        <div class="error-msg" id="gallery-error"></div>
        
        <div class="form-group">
          <label>Image URL</label>
          <input type="text" id="g-img" placeholder="https://...">
          <label>Caption / Project Name</label>
          <input type="text" id="g-cap" placeholder="e.g. Grazeland Estate">
          <button class="btn-generate" onclick="saveGallery()">Save to Database</button>
        </div>

        <h3 style="margin-top: 40px; color: var(--navy);">Gallery Items</h3>
        <div class="items-list" id="gallery-list"></div>
      </div>

    </div>
  </div>

  <script>
    const API_URL = 'https://harkein-backend-production.up.railway.app';
    const PASSWORD = "@Folaranmi2003";
    let authToken = localStorage.getItem('authToken');
    
    // AUTO-LOGOUT TIMER (30 minutes)
    const INACTIVITY_TIMEOUT = 30 * 60 * 1000; // 30 minutes in milliseconds
    const WARNING_TIME = 5 * 60 * 1000; // Show warning at 5 minutes remaining
    let inactivityTimer;
    let sessionStartTime;
    let timerInterval;

    function startInactivityTimer() {
      sessionStartTime = Date.now();
      resetInactivityTimer();
      startTimerDisplay();
      
      // Reset timer on any user activity
      ['mousedown', 'mousemove', 'keypress', 'scroll', 'touchstart', 'click'].forEach(event => {
        document.addEventListener(event, resetInactivityTimer, true);
      });
    }

    function resetInactivityTimer() {
      clearTimeout(inactivityTimer);
      sessionStartTime = Date.now();
      
      inactivityTimer = setTimeout(() => {
        alert('Your session has expired due to inactivity. Please login again.');
        logout();
      }, INACTIVITY_TIMEOUT);
    }

    function startTimerDisplay() {
      timerInterval = setInterval(() => {
        const elapsed = Date.now() - sessionStartTime;
        const remaining = INACTIVITY_TIMEOUT - elapsed;
        
        if (remaining <= 0) {
          clearInterval(timerInterval);
          return;
        }
        
        const minutes = Math.floor(remaining / 60000);
        const seconds = Math.floor((remaining % 60000) / 1000);
        const display = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        
        const timerElement = document.getElementById('timer-display');
        const timerContainer = document.getElementById('session-timer');
        
        if (timerElement) {
          timerElement.textContent = display;
          
          // Show warning when less than 5 minutes remaining
          if (remaining <= WARNING_TIME) {
            timerContainer.classList.add('warning');
          } else {
            timerContainer.classList.remove('warning');
          }
        }
      }, 1000);
    }

    async function checkLogin() {
        const password = document.getElementById("password").value;
        
        try {
            const response = await fetch(`${API_URL}/api/auth/login`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ password })
            });
            
            const data = await response.json();
            
            if (response.ok) {
                authToken = data.token;
                localStorage.setItem('authToken', authToken);
                document.getElementById("login-screen").style.display = "none";
                document.getElementById("main-interface").style.display = "flex";
                startInactivityTimer(); // Start the auto-logout timer
                loadAllData();
            } else {
                document.getElementById("error-msg").style.display = "block";
            }
        } catch (error) {
            console.error('Login error:', error);
            document.getElementById("error-msg").textContent = "Connection error - Check backend URL";
            document.getElementById("error-msg").style.display = "block";
        }
    }

    function switchTab(tabId) {
        document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        event.currentTarget.classList.add('active');
        loadData(tabId);
    }

    function logout() { 
        clearTimeout(inactivityTimer);
        clearInterval(timerInterval);
        localStorage.removeItem('authToken');
        location.reload(); 
    }

    function showMessage(type, section, message) {
        const el = document.getElementById(`${section}-${type}`);
        el.textContent = message;
        el.style.display = 'block';
        setTimeout(() => el.style.display = 'none', 3000);
    }

    async function saveFashion() {
        const data = {
            img: document.getElementById('f-img').value,
            name: document.getElementById('f-name').value,
            price: document.getElementById('f-price').value,
            category: document.getElementById('f-cat').value
        };
        await saveItem('fashion', data);
        loadData('fashion');
        clearForm('f');
    }

    async function saveProperty() {
        const data = {
            img: document.getElementById('p-img').value,
            title: document.getElementById('p-title').value,
            price: document.getElementById('p-price').value,
            location: document.getElementById('p-loc').value,
            status: document.getElementById('p-status').value
        };
        await saveItem('property', data);
        loadData('realestate');
        clearForm('p');
    }

    async function saveEnergy() {
        const data = {
            img: document.getElementById('e-img').value,
            title: document.getElementById('e-title').value,
            desc: document.getElementById('e-desc').value
        };
        await saveItem('energy', data);
        loadData('energy');
        clearForm('e');
    }

    async function saveSolutions() {
        const data = {
            img: document.getElementById('s-img').value,
            title: document.getElementById('s-title').value,
            desc: document.getElementById('s-desc').value
        };
        await saveItem('solutions', data);
        loadData('solutions');
        clearForm('s');
    }

    async function saveLogistics() {
        const data = {
            icon: document.getElementById('l-icon').value,
            title: document.getElementById('l-title').value,
            desc: document.getElementById('l-desc').value
        };
        await saveItem('logistics', data);
        loadData('logistics');
        clearForm('l');
    }

    async function saveNews() {
        const data = {
            img: document.getElementById('n-img').value,
            title: document.getElementById('n-title').value,
            desc: document.getElementById('n-desc').value,
            date: document.getElementById('n-date').value,
            link: document.getElementById('n-link').value
        };
        await saveItem('news', data);
        loadData('news');
        clearForm('n');
    }

    async function saveGallery() {
        const data = {
            img: document.getElementById('g-img').value,
            caption: document.getElementById('g-cap').value
        };
        await saveItem('gallery', data);
        loadData('gallery');
        clearForm('g');
    }

    async function saveItem(type, data) {
        try {
            const response = await fetch(`${API_URL}/api/items`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${authToken}`
                },
                body: JSON.stringify({ type, data })
            });
            
            if (response.ok) {
                showMessage('success', type, '✅ Item saved successfully!');
            } else {
                showMessage('error', type, '❌ Error saving item');
            }
        } catch (error) {
            console.error('Save error:', error);
            showMessage('error', type, '❌ Connection error');
        }
    }

    async function deleteItem(type, id) {
        if (!confirm('Are you sure you want to delete this item?')) return;
        
        try {
            const response = await fetch(`${API_URL}/api/items/${id}`, {
                method: 'DELETE',
                headers: { 'Authorization': `Bearer ${authToken}` }
            });
            
            if (response.ok) {
                loadData(type);
            }
        } catch (error) {
            console.error('Delete error:', error);
        }
    }

    async function loadData(section) {
        const typeMap = {
            'fashion': 'fashion',
            'realestate': 'property',
            'energy': 'energy',
            'solutions': 'solutions',
            'logistics': 'logistics',
            'news': 'news',
            'gallery': 'gallery'
        };
        
        const type = typeMap[section];
        if (!type) return;
        
        try {
            const response = await fetch(`${API_URL}/api/items/${type}`);
            const items = await response.json();
            displayItems(section, type, items);
        } catch (error) {
            console.error('Load error:', error);
        }
    }

    function displayItems(section, type, items) {
        const listId = `${section === 'realestate' ? 'property' : section}-list`;
        const list = document.getElementById(listId);
        
        if (items.length === 0) {
            list.innerHTML = '<p style="color: #999;">No items yet</p>';
            return;
        }
        
        list.innerHTML = items.map(item => `
            <div class="item-card">
                <h3>${item.data.name || item.data.title || item.data.caption}</h3>
                ${item.data.price ? `<p><strong>Price:</strong> ${item.data.price}</p>` : ''}
                ${item.data.location ? `<p><strong>Location:</strong> ${item.data.location}</p>` : ''}
                ${item.data.desc ? `<p>${item.data.desc.substring(0, 100)}...</p>` : ''}
                <p><small>Created: ${new Date(item.createdAt).toLocaleDateString()}</small></p>
                <div class="item-actions">
                    <button class="btn-delete" onclick="deleteItem('${section}', '${item._id}')">Delete</button>
                </div>
            </div>
        `).join('');
    }

    function clearForm(prefix) {
        document.querySelectorAll(`[id^="${prefix}-"]`).forEach(el => {
            if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') el.value = '';
        });
    }

    function loadAllData() {
        loadData('fashion');
        loadData('realestate');
        loadData('energy');
        loadData('solutions');
        loadData('logistics');
        loadData('news');
        loadData('gallery');
    }

    if (authToken) {
        document.getElementById("login-screen").style.display = "none";
        document.getElementById("main-interface").style.display = "flex";
        startInactivityTimer(); // Start timer on auto-login
        loadAllData();
    }
  </script>
</body>
</html>
